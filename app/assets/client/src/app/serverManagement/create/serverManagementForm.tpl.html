<div ng-controller="serverManagementFormCtrl as vm">
    <div class="well">
        <form name="vm.form" ng-submit="vm.onSubmit(vm.form)" novalidate>
            <div class="form-group" ng-class="{ 'has-error' : vm.form.serverName.$invalid && !vm.form.serverName.$pristine }">
                <label for="serverName">Server name</label>
                <input type="text" class="form-control" name="serverName" id="serverName" placeholder="Enter server name"
                       ng-model="vm.server.name" ng-pattern="/[a-zA-Z\.\-0-9]+/g" required><!--todo: fix regex-->
                <div ng-show="!vm.form.serverName.$pristine && vm.form.serverName.$error">
                    <p ng-show="vm.form.serverName.$error.pattern">Your server name must only contain alphanumeric characters, dashes, and periods.</p>
                </div>
            </div>

            <div class="form-group">
                <label for="serverRegion">Server region</label>
                <select name="serverRegion" class="form-control" name="serverRegion" id="serverRegion"
                        ng-model="vm.server.region" ng-disabled="!vm.serverOptions"
                        ng-options="value.name group by value.group disable when !value.available for (label, value) in vm.serverOptions.regions" required></select>
            </div>

            <div class="form-group">
                <label for="serverSize">Server size</label>
                <select name="serverSize" class="form-control" name="serverSize" id="serverSize"
                        ng-model="vm.server.size"
                        ng-disabled="!vm.serverOptions || !vm.server.region || !vm.server.region.sizes.length"
                        ng-options="option for option in vm.server.region.sizes" required></select>
            </div>

            <div class="form-group" ng-class="{ 'has-error' : vm.form.discoveryToken.$invalid && !vm.form.discoveryToken.$pristine }">
                <label for="discoveryToken">Discovery token</label>
                <div class="input-group">
                    <input type="url" class="form-control" name="discoveryToken" id="discoveryToken"
                           placeholder="Enter a discovery token" ng-model="vm.server.discovery_token" required>
                     <span class="input-group-btn">
                         <button class="btn btn-default" type="button" ng-click="vm.generateToken()">
                             <span class="mdi mdi-refresh"></span>
                         </button>
                     </span>
                </div>

                <p class="help-block">Use an existing token to .... A new token can be generated on
                    <a href="https://discovery.etcd.io/new" target="_blank">https://discovery.etcd.io/new</a>.
                    Leaving this field empty will result in a newly generated token.</p>
            </div>

            <div class="form-group">
                <label for="sshKeyId">SSH key</label>
                <select class="form-control" name="sshKeyId" id="sshKeyId" ng-model="vm.server.ssh_keys"
                        ng-options="item.name for item in vm.sshKeys" required></select>
                <p class="help-block">Select a SSH key to ...</p>
            </div>

            <div class="form-group">
                <div class="checkbox">
                    <label for="backupsEnabled">
                        <input type="checkbox" name="backupsEnabled" id="backupsEnabled"
                               ng-model="vm.server.backups">
                        Enable backups
                    </label>
                </div>
            </div>

            <div class="form-group">
                <div class="checkbox">
                    <label for="ipv6Enabled">
                        <input type="checkbox" name="ipv6Enabled" id="ipv6Enabled"
                               ng-model="vm.server.ipv6">
                        Enable IPv6
                    </label>
                </div>
            </div>

            <button type="submit" class="btn btn-primary" ng-disabled="vm.form.$invalid">Create server</button>
        </form>
    </div>
</div>
